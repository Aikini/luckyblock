def luckyConfigDir = "$projectDir/lucky_config"
def luckyRunConfigDir = "$projectDir/run/config/lucky_block/version-${project.version}"
def distDir = "$buildDir/libs"

task luckyCopyRunConfig(type: Copy) {
    from luckyConfigDir
    into luckyRunConfigDir
}

task luckyZipConfig(type: Zip) {
    destinationDir = file(distDir)
    archiveName = 'default_config.zip'
    from luckyConfigDir
}

task luckyPackage(type: Zip) {
    destinationDir = file(distDir)
    archiveName = "${project.jarName}.zip" 
    from zipTree("$distDir/${project.jarNameRaw}.jar")
    from("$distDir/default_config.zip") {
        into ('mod/lucky')
    }
}

task luckyClient {
    dependsOn luckyCopyRunConfig
    dependsOn 'runClient'
}
task luckyServer {
    dependsOn luckyCopyRunConfig
    dependsOn 'runServer'
}

task luckyBuild {
    dependsOn build
    dependsOn luckyZipConfig
    dependsOn luckyPackage

    luckyZipConfig.shouldRunAfter(build)
    luckyPackage.shouldRunAfter(luckyZipConfig)
}
